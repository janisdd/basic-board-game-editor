!function(e){function t(r){if(n[r])return n[r].exports;var a=n[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,t),a.l=!0,a.exports}var n={};t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=90)}({127:function(e,t,n){"use strict";function r(e){return void 0!==e.val}function a(e){return void 0!==e.boolVal}Object.defineProperty(t,"__esModule",{value:!0}),t.isIntVar=r,t.isBoolVar=a},184:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.currentPlayer=0]="currentPlayer",e[e.nextPlayer=1]="nextPlayer",e[e.previousPlayer=2]="previousPlayer"}(t.SomePlayer||(t.SomePlayer={}));!function(e){e[e.int=0]="int",e[e.bool=1]="bool"}(t.VarType||(t.VarType={}))},24:function(e,t){e.exports=function(){throw new Error("define cannot be used indirect")}},277:function(e,t,n){var r=n(278),a=n(279),l=n(280),i=n(281),o=n(282),s=n(283),u=n(284);u.alea=r,u.xor128=a,u.xorwow=l,u.xorshift7=i,u.xor4096=o,u.tychei=s,e.exports=u},278:function(e,t,n){(function(e){var r;!function(e,a,l){function i(e){var t=this,n=u();t.next=function(){var e=2091639*t.s0+2.3283064365386963e-10*t.c;return t.s0=t.s1,t.s1=t.s2,t.s2=e-(t.c=0|e)},t.c=1,t.s0=n(" "),t.s1=n(" "),t.s2=n(" "),t.s0-=n(e),t.s0<0&&(t.s0+=1),t.s1-=n(e),t.s1<0&&(t.s1+=1),t.s2-=n(e),t.s2<0&&(t.s2+=1),n=null}function o(e,t){return t.c=e.c,t.s0=e.s0,t.s1=e.s1,t.s2=e.s2,t}function s(e,t){var n=new i(e),r=t&&t.state,a=n.next;return a.int32=function(){return 4294967296*n.next()|0},a.double=function(){return a()+1.1102230246251565e-16*(2097152*a()|0)},a.quick=a,r&&("object"==typeof r&&o(r,n),a.state=function(){return o(n,{})}),a}function u(){var e=4022871197;return function(t){t=t.toString();for(var n=0;n<t.length;n++){e+=t.charCodeAt(n);var r=.02519603282416938*e;e=r>>>0,r-=e,r*=e,e=r>>>0,r-=e,e+=4294967296*r}return 2.3283064365386963e-10*(e>>>0)}}a&&a.exports?a.exports=s:n(24)&&n(41)?void 0!==(r=function(){return s}.call(t,n,t,a))&&(a.exports=r):this.alea=s}(0,"object"==typeof e&&e,n(24))}).call(t,n(30)(e))},279:function(e,t,n){(function(e){var r;!function(e,a,l){function i(e){var t=this,n="";t.x=0,t.y=0,t.z=0,t.w=0,t.next=function(){var e=t.x^t.x<<11;return t.x=t.y,t.y=t.z,t.z=t.w,t.w^=t.w>>>19^e^e>>>8},e===(0|e)?t.x=e:n+=e;for(var r=0;r<n.length+64;r++)t.x^=0|n.charCodeAt(r),t.next()}function o(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t}function s(e,t){var n=new i(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=n.next()>>>11,t=(n.next()>>>0)/4294967296,r=(e+t)/(1<<21)}while(0===r);return r},a.int32=n.next,a.quick=a,r&&("object"==typeof r&&o(r,n),a.state=function(){return o(n,{})}),a}a&&a.exports?a.exports=s:n(24)&&n(41)?void 0!==(r=function(){return s}.call(t,n,t,a))&&(a.exports=r):this.xor128=s}(0,"object"==typeof e&&e,n(24))}).call(t,n(30)(e))},280:function(e,t,n){(function(e){var r;!function(e,a,l){function i(e){var t=this,n="";t.next=function(){var e=t.x^t.x>>>2;return t.x=t.y,t.y=t.z,t.z=t.w,t.w=t.v,(t.d=t.d+362437|0)+(t.v=t.v^t.v<<4^e^e<<1)|0},t.x=0,t.y=0,t.z=0,t.w=0,t.v=0,e===(0|e)?t.x=e:n+=e;for(var r=0;r<n.length+64;r++)t.x^=0|n.charCodeAt(r),r==n.length&&(t.d=t.x<<10^t.x>>>4),t.next()}function o(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t.v=e.v,t.d=e.d,t}function s(e,t){var n=new i(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=n.next()>>>11,t=(n.next()>>>0)/4294967296,r=(e+t)/(1<<21)}while(0===r);return r},a.int32=n.next,a.quick=a,r&&("object"==typeof r&&o(r,n),a.state=function(){return o(n,{})}),a}a&&a.exports?a.exports=s:n(24)&&n(41)?void 0!==(r=function(){return s}.call(t,n,t,a))&&(a.exports=r):this.xorwow=s}(0,"object"==typeof e&&e,n(24))}).call(t,n(30)(e))},281:function(e,t,n){(function(e){var r;!function(e,a,l){function i(e){var t=this;t.next=function(){var e,n,r=t.x,a=t.i;return e=r[a],e^=e>>>7,n=e^e<<24,e=r[a+1&7],n^=e^e>>>10,e=r[a+3&7],n^=e^e>>>3,e=r[a+4&7],n^=e^e<<7,e=r[a+7&7],e^=e<<13,n^=e^e<<9,r[a]=n,t.i=a+1&7,n},function(e,t){var n,r=[];if(t===(0|t))r[0]=t;else for(t=""+t,n=0;n<t.length;++n)r[7&n]=r[7&n]<<15^t.charCodeAt(n)+r[n+1&7]<<13;for(;r.length<8;)r.push(0);for(n=0;n<8&&0===r[n];++n);for(8==n?r[7]=-1:r[n],e.x=r,e.i=0,n=256;n>0;--n)e.next()}(t,e)}function o(e,t){return t.x=e.x.slice(),t.i=e.i,t}function s(e,t){null==e&&(e=+new Date);var n=new i(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=n.next()>>>11,t=(n.next()>>>0)/4294967296,r=(e+t)/(1<<21)}while(0===r);return r},a.int32=n.next,a.quick=a,r&&(r.x&&o(r,n),a.state=function(){return o(n,{})}),a}a&&a.exports?a.exports=s:n(24)&&n(41)?void 0!==(r=function(){return s}.call(t,n,t,a))&&(a.exports=r):this.xorshift7=s}(0,"object"==typeof e&&e,n(24))}).call(t,n(30)(e))},282:function(e,t,n){(function(e){var r;!function(e,a,l){function i(e){var t=this;t.next=function(){var e,n,r=t.w,a=t.X,l=t.i;return t.w=r=r+1640531527|0,n=a[l+34&127],e=a[l=l+1&127],n^=n<<13,e^=e<<17,n^=n>>>15,e^=e>>>12,n=a[l]=n^e,t.i=l,n+(r^r>>>16)|0},function(e,t){var n,r,a,l,i,o=[],s=128;for(t===(0|t)?(r=t,t=null):(t+="\0",r=0,s=Math.max(s,t.length)),a=0,l=-32;l<s;++l)t&&(r^=t.charCodeAt((l+32)%t.length)),0===l&&(i=r),r^=r<<10,r^=r>>>15,r^=r<<4,r^=r>>>13,l>=0&&(i=i+1640531527|0,n=o[127&l]^=r+i,a=0==n?a+1:0);for(a>=128&&(o[127&(t&&t.length||0)]=-1),a=127,l=512;l>0;--l)r=o[a+34&127],n=o[a=a+1&127],r^=r<<13,n^=n<<17,r^=r>>>15,n^=n>>>12,o[a]=r^n;e.w=i,e.X=o,e.i=a}(t,e)}function o(e,t){return t.i=e.i,t.w=e.w,t.X=e.X.slice(),t}function s(e,t){null==e&&(e=+new Date);var n=new i(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=n.next()>>>11,t=(n.next()>>>0)/4294967296,r=(e+t)/(1<<21)}while(0===r);return r},a.int32=n.next,a.quick=a,r&&(r.X&&o(r,n),a.state=function(){return o(n,{})}),a}a&&a.exports?a.exports=s:n(24)&&n(41)?void 0!==(r=function(){return s}.call(t,n,t,a))&&(a.exports=r):this.xor4096=s}(0,"object"==typeof e&&e,n(24))}).call(t,n(30)(e))},283:function(e,t,n){(function(e){var r;!function(e,a,l){function i(e){var t=this,n="";t.next=function(){var e=t.b,n=t.c,r=t.d,a=t.a;return e=e<<25^e>>>7^n,n=n-r|0,r=r<<24^r>>>8^a,a=a-e|0,t.b=e=e<<20^e>>>12^n,t.c=n=n-r|0,t.d=r<<16^n>>>16^a,t.a=a-e|0},t.a=0,t.b=0,t.c=-1640531527,t.d=1367130551,e===Math.floor(e)?(t.a=e/4294967296|0,t.b=0|e):n+=e;for(var r=0;r<n.length+20;r++)t.b^=0|n.charCodeAt(r),t.next()}function o(e,t){return t.a=e.a,t.b=e.b,t.c=e.c,t.d=e.d,t}function s(e,t){var n=new i(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=n.next()>>>11,t=(n.next()>>>0)/4294967296,r=(e+t)/(1<<21)}while(0===r);return r},a.int32=n.next,a.quick=a,r&&("object"==typeof r&&o(r,n),a.state=function(){return o(n,{})}),a}a&&a.exports?a.exports=s:n(24)&&n(41)?void 0!==(r=function(){return s}.call(t,n,t,a))&&(a.exports=r):this.tychei=s}(0,"object"==typeof e&&e,n(24))}).call(t,n(30)(e))},284:function(e,t,n){var r;!function(a,l){function i(e,t,n){var r=[];t=1==t?{entropy:!0}:t||{};var i=c(u(t.entropy?[e,p(a)]:null==e?f():e,3),r),_=new o(r),d=function(){for(var e=_.g(v),t=y,n=0;e<b;)e=(e+n)*m,t*=m,n=_.g(1);for(;e>=h;)e/=2,t/=2,n>>>=1;return(e+n)/t};return d.int32=function(){return 0|_.g(4)},d.quick=function(){return _.g(4)/4294967296},d.double=d,c(p(_.S),a),(t.pass||n||function(e,t,n,r){return r&&(r.S&&s(r,_),e.state=function(){return s(_,{})}),n?(l[x]=e,t):e})(d,i,"global"in t?t.global:this==l,t.state)}function o(e){var t,n=e.length,r=this,a=0,l=r.i=r.j=0,i=r.S=[];for(n||(e=[n++]);a<m;)i[a]=a++;for(a=0;a<m;a++)i[a]=i[l=I&l+e[a%n]+(t=i[a])],i[l]=t;(r.g=function(e){for(var t,n=0,a=r.i,l=r.j,i=r.S;e--;)t=i[a=I&a+1],n=n*m+i[I&(i[a]=i[l=I&l+t])+(i[l]=t)];return r.i=a,r.j=l,n})(m)}function s(e,t){return t.i=e.i,t.j=e.j,t.S=e.S.slice(),t}function u(e,t){var n,r=[],a=typeof e;if(t&&"object"==a)for(n in e)try{r.push(u(e[n],t-1))}catch(e){}return r.length?r:"string"==a?e:e+"\0"}function c(e,t){for(var n,r=e+"",a=0;a<r.length;)t[I&a]=I&(n^=19*t[I&a])+r.charCodeAt(a++);return p(t)}function f(){try{var e;return _&&(e=_.randomBytes)?e=e(m):(e=new Uint8Array(m),(d.crypto||d.msCrypto).getRandomValues(e)),p(e)}catch(e){var t=d.navigator,n=t&&t.plugins;return[+new Date,d,n,d.screen,p(a)]}}function p(e){return String.fromCharCode.apply(0,e)}var _,d=this,m=256,v=6,x="random",y=l.pow(m,v),b=l.pow(2,52),h=2*b,I=m-1;if(l["seed"+x]=i,c(l.random(),a),"object"==typeof e&&e.exports){e.exports=i;try{_=n(285)}catch(e){}}else void 0!==(r=function(){return i}.call(t,n,t,e))&&(e.exports=r)}([],Math)},285:function(e,t){},29:function(e,t,n){"use strict";function r(e){}Object.defineProperty(t,"__esModule",{value:!0}),t.notExhaustive=r},30:function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},41:function(e,t){(function(t){e.exports=t}).call(t,{})},5:function(e,t,n){"use strict";function r(e,t){function n(){this.constructor=e}b(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}function a(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var a=0,r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&(n[r[a]]=e[r[a]]);return n}function l(e,t,n,r){var a,l=arguments.length,i=l<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,n,r);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(i=(l<3?a(i):l>3?a(t,n,i):a(t,n))||i);return l>3&&i&&Object.defineProperty(t,n,i),i}function i(e,t){return function(n,r){t(n,r,e)}}function o(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function s(e,t,n,r){return new(n||(n=Promise))(function(a,l){function i(e){try{s(r.next(e))}catch(e){l(e)}}function o(e){try{s(r.throw(e))}catch(e){l(e)}}function s(e){e.done?a(e.value):new n(function(t){t(e.value)}).then(i,o)}s((r=r.apply(e,t||[])).next())})}function u(e,t){function n(e){return function(t){return r([e,t])}}function r(n){if(a)throw new TypeError("Generator is already executing.");for(;s;)try{if(a=1,l&&(i=l[2&n[0]?"return":n[0]?"throw":"next"])&&!(i=i.call(l,n[1])).done)return i;switch(l=0,i&&(n=[0,i.value]),n[0]){case 0:case 1:i=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,l=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(i=s.trys,!(i=i.length>0&&i[i.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!i||n[1]>i[0]&&n[1]<i[3])){s.label=n[1];break}if(6===n[0]&&s.label<i[1]){s.label=i[1],i=n;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(n);break}i[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],l=0}finally{a=i=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var a,l,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o}function c(e,t){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}function f(e){var t="function"==typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}function p(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,l=n.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(r=l.next()).done;)i.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=l.return)&&n.call(l)}finally{if(a)throw a.error}}return i}function _(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(p(arguments[t]));return e}function d(e){return this instanceof d?(this.v=e,this):new d(e)}function m(e,t,n){function r(e){c[e]&&(u[e]=function(t){return new Promise(function(n,r){f.push([e,t,n,r])>1||a(e,t)})})}function a(e,t){try{l(c[e](t))}catch(e){s(f[0][3],e)}}function l(e){e.value instanceof d?Promise.resolve(e.value.v).then(i,o):s(f[0][2],e)}function i(e){a("next",e)}function o(e){a("throw",e)}function s(e,t){e(t),f.shift(),f.length&&a(f[0][0],f[0][1])}if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var u,c=n.apply(e,t||[]),f=[];return u={},r("next"),r("throw"),r("return"),u[Symbol.asyncIterator]=function(){return this},u}function v(e){function t(t,a){e[t]&&(n[t]=function(n){return(r=!r)?{value:d(e[t](n)),done:"return"===t}:a?a(n):n})}var n,r;return n={},t("next"),t("throw",function(e){throw e}),t("return"),n[Symbol.iterator]=function(){return this},n}function x(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator];return t?t.call(e):"function"==typeof f?f(e):e[Symbol.iterator]()}function y(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}Object.defineProperty(t,"__esModule",{value:!0}),t.__extends=r,n.d(t,"__assign",function(){return h}),t.__rest=a,t.__decorate=l,t.__param=i,t.__metadata=o,t.__awaiter=s,t.__generator=u,t.__exportStar=c,t.__values=f,t.__read=p,t.__spread=_,t.__await=d,t.__asyncGenerator=m,t.__asyncDelegator=v,t.__asyncValues=x,t.__makeTemplateObject=y;/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
var b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},h=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e}},90:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(5),a=n(184),l=n(127),i=n(29),o=n(277),s=function(){function e(){}return e.timeInS_rollDice=function(){return this._timeInS_rollDice},e.timeInS_choose_bool_func=function(){return this._timeInS_choose_bool_func},e.timeInS_goto=function(){return this._timeInS_goto},e.timeInS_set_var=function(){return this._timeInS_set_var},e.timeInS_advancePlayer=function(){return this._timeInS_advancePlayer},e.timeInS_rollback=function(){return this._timeInS_rollback},e.timeInS_var_decl=function(){return this._timeInS_var_decl},e.timeInS_expr_primary_leftSteps=function(){return this._timeInS_expr_primary_leftSteps},e.timeInS_expr_primary_constant=function(){return this._timeInS_expr_primary_constant},e.timeInS_expr_primary_ident=function(){return this._timeInS_expr_primary_ident},e.timeInS_expr_primary_incrementOrDecrement=function(){return this._timeInS_expr_primary_incrementOrDecrement},e.timeInS_expr_disjunction=function(){return this._timeInS_expr_disjunction},e.timeInS_expr_conjunction=function(){return this._timeInS_expr_conjunction},e.timeInS_expr_comparison=function(){return this._timeInS_expr_comparison},e.timeInS_expr_relation=function(){return this._timeInS_expr_relation},e.timeInS_expr_sum=function(){return this._timeInS_expr_sum},e.timeInS_expr_term=function(){return this._timeInS_expr_term},e.timeInS_expr_factor=function(){return this._timeInS_expr_factor},e.timeInS_rollDice_default=2,e.timeInS_choose_bool_func_default=.3,e.timeInS_goto_default=.5,e.timeInS_set_var_default=3,e.timeInS_advancePlayer_default=1,e.timeInS_rollback_default=2,e.timeInS_var_decl_default=3,e.timeInS_expr_primary_leftSteps_default=2,e.timeInS_expr_primary_constant_default=.5,e.timeInS_expr_primary_ident_default=1,e.timeInS_expr_primary_incrementOrDecrement_default=1,e.timeInS_expr_disjunction_default=1,e.timeInS_expr_conjunction_default=1,e.timeInS_expr_comparison_default=1,e.timeInS_expr_relation_default=1,e.timeInS_expr_sum_default=1,e.timeInS_expr_term_default=1,e.timeInS_expr_factor_default=1,e._timeInS_rollDice=e.timeInS_rollDice_default,e._timeInS_choose_bool_func=e.timeInS_choose_bool_func_default,e._timeInS_goto=e.timeInS_goto_default,e._timeInS_set_var=e.timeInS_set_var_default,e._timeInS_advancePlayer=e.timeInS_advancePlayer_default,e._timeInS_rollback=e.timeInS_rollback_default,e._timeInS_var_decl=e.timeInS_var_decl_default,e._timeInS_expr_primary_leftSteps=e.timeInS_expr_primary_leftSteps_default,e._timeInS_expr_primary_constant=e.timeInS_expr_primary_constant_default,e._timeInS_expr_primary_ident=e.timeInS_expr_primary_ident_default,e._timeInS_expr_primary_incrementOrDecrement=e.timeInS_expr_primary_incrementOrDecrement_default,e._timeInS_expr_disjunction=e.timeInS_expr_disjunction_default,e._timeInS_expr_conjunction=e.timeInS_expr_conjunction_default,e._timeInS_expr_comparison=e.timeInS_expr_comparison_default,e._timeInS_expr_relation=e.timeInS_expr_relation_default,e._timeInS_expr_sum=e.timeInS_expr_sum_default,e._timeInS_expr_term=e.timeInS_expr_term_default,e._timeInS_expr_factor=e.timeInS_expr_factor_default,e}();t.SimulationTimes=s,t.playerColors=["#00dd0a","#0089dd","#dd0011","#f1f300","#f300b5"];var u=o(),c=function(){function e(){}return e.createNewMachineState=function(){return{globalDefTable:{},currentPlayerIndex:0,nextPlayerIndex:0,previousPlayerIndex:0,currentPlayerActiveTokenIndex:0,players:[{tokens:[],defTable:{},suspendCounter:0,color:"",name:"default player",id:-1,localDefTables:[{isScopeLimited:!1,defTable:{}}],lastReturnedValue:void 0}],rolledDiceValue:0,leftDiceValue:0,maxDiceValue:0,gameEndCondition:null,rollbackState:null,wasStateRolledBack:!1,elapsedTimeInS:0,winnersIds:[]}},e.setSeed=function(e){u=o(null===e?null:e.toString())},e.rollDice=function(e,t,n){return void 0===t&&(t=1),void 0===n&&(n=6),{state:r.__assign({},e,{elapsedTimeInS:e.elapsedTimeInS+s.timeInS_rollDice()}),diceValue:Math.floor(u.quick()*n+t)}},e.advancePlayerIndex=function(e){var t=(e.currentPlayerIndex+1)%e.players.length;return r.__assign({},e,{currentPlayerIndex:t,nextPlayerIndex:(t+1)%e.players.length,previousPlayerIndex:t-1<0?e.players.length-1:t-1,elapsedTimeInS:e.elapsedTimeInS+s.timeInS_advancePlayer()})},e.executeAllGameDefinitionStatements=function(e,t){for(var n=t,r=0;r<e.length;r++){var a=e[r];n=this.executeGameDefinitionStatement(a,n)}return n},e.executeGameDefinitionStatement=function(e,t){switch(e.type){case"game_vars":var n=this.execGameDef(e,t);return n;case"players_def":var n=this.execPlayerDef(e,t);return n;default:i.notExhaustive(e)}},e.execPlayerDef=function(e,n){n.players.length>0&&-1!==n.players[0].id&&this.makeError("players def can only be defined once"),e.numTokensPerPlayer<=0&&this.makeError("a player needs at least 1 token --\x3e set numTokensPerPlayer to >= 1");for(var a=r.__assign({},n,{players:[]}),l=0;l<e.numPlayers;l++){for(var i=t.playerColors[l],o=[],s=0;s<e.numTokensPerPlayer;s++){var u={color:i,fieldId:null,tileGuid:null,name:"player"+l+"_token"+s,previousPositions:[]};o.push(u)}var c={id:l,color:i,name:"player"+l,defTable:{},localDefTables:[{isScopeLimited:!1,defTable:{}}],tokens:o,suspendCounter:0,lastReturnedValue:void 0};a=r.__assign({},a,{players:a.players.concat(c),currentPlayerIndex:l});a=this.execPlayerVars(e.vars,a,l)}return a=r.__assign({},a,{currentPlayerIndex:0,nextPlayerIndex:1%a.players.length,previousPlayerIndex:a.players.length-1})},e.execPlayerVars=function(e,t,n){for(var l=this,i=t,o=this,s=0;s<e.length;s++)!function(s){var u=e[s];void 0===t.players[n]&&o.makeError("player with index "+n+" was not found (execPlayerVars)"),i.players[n].defTable[u.ident]&&o.makeError("player var "+u.ident+" is already defined");var c=o.execExpression(u.expr,i);i=c.state,u.var_type===a.VarType.int?(null!==c.boolVal&&o.makeError("player var "+u.ident+" is of type int but expression is of type bool"),i=r.__assign({},i,{players:i.players.map(function(e,t){return n!==t?e:r.__assign({},e,{defTable:r.__assign({},e.defTable,(a={},a[u.ident]={val:l.circularArithmeticVal(c.val,u.maxVal+1,u.maxVal),ident:u.ident,maxVal:u.maxVal},a))});var a})})):u.var_type===a.VarType.bool&&(null!==c.val&&o.makeError("player var "+u.ident+" is of type bool but expression is of type int"),i=r.__assign({},i,{players:i.players.map(function(e,t){return n!==t?e:r.__assign({},e,{defTable:r.__assign({},e.defTable,(a={},a[u.ident]={boolVal:c.boolVal,ident:u.ident},a))});var a})}))}(s);return i},e.execPlayerVarAssign=function(e,t){var n=this.getSomePlayerIndex(e.player,t,"primary_player_var_ident unknown player"),r=t.players[n].defTable[e.ident];r||this.makeError("player var assign unknown var "+e.ident+" for player");var a=this.execExpression(e.expr,t);return t=a.state,this._execPlayerVarAssign(r,n,a,t)},e._execPlayerVarAssign=function(e,t,n,a){if(null!==n.val&&(l.isBoolVar(e)&&this.makeError("player var assign var "+e.ident+" is of type bool but epxr is of type int"),l.isIntVar(e))){var i=r.__assign({},n.state,{players:a.players.map(function(a,l){return l!==t?a:r.__assign({},a,{defTable:r.__assign({},a.defTable,(i={},i[e.ident]={val:n.val,maxVal:e.maxVal,ident:e.ident},i))});var i}),elapsedTimeInS:n.state.elapsedTimeInS+s.timeInS_set_var()});return{val:n.val,boolVal:null,state:i}}if(null!==n.boolVal&&(l.isIntVar(e)&&this.makeError("player var assign var "+e.ident+" is of type int but epxr is of type bool"),l.isBoolVar(e))){var i=r.__assign({},n.state,{players:a.players.map(function(a,l){return l!==t?a:r.__assign({},a,{defTable:r.__assign({},a.defTable,(i={},i[e.ident]={boolVal:n.boolVal,ident:e.ident},i))});var i}),elapsedTimeInS:n.state.elapsedTimeInS+s.timeInS_set_var()});return{val:null,boolVal:n.boolVal,state:i}}return this.makeError("player var assign var "+e.ident+" unknown val/type"),null},e.execGameDef=function(e,t){var n=this.execGameVars(e.vars,t);return r.__assign({},n,{maxDiceValue:e.maxDiceValue,gameEndCondition:e.endCondition})},e.execGameVars=function(e,t){for(var n=0;n<e.length;n++){var l=e[n];t.globalDefTable[l.ident]&&this.makeError("global var "+l.ident+" is already defined");var i=this.execExpression(l.expr,t);t=i.state,l.var_type===a.VarType.int?(null!==i.boolVal&&this.makeError("global var "+l.ident+" is of type int but expression is of type bool"),t=r.__assign({},t,{globalDefTable:r.__assign({},t.globalDefTable,(o={},o[l.ident]={val:this.circularArithmeticVal(i.val,l.maxVal+1,l.maxVal),ident:l.ident,maxVal:l.maxVal},o))})):l.var_type===a.VarType.bool&&(null!==i.val&&this.makeError("global var "+l.ident+" is of type bool but expression is of type int"),t=r.__assign({},t,{globalDefTable:r.__assign({},t.globalDefTable,(s={},s[l.ident]={boolVal:i.boolVal,ident:l.ident},s))}))}return t;var o,s},e.executeAll=function(e,t){for(var n=t,r=0;r<e.length;r++){var a=e[r];n=this.executeStatement(a,n)}return n},e.executeStatement=function(e,t){switch(e.type){case"var_decl":var n=this.execVarDecl(e,t);return n;case"expression":var n=this.execExpression(e,t);return n.state;case"log":var n=this.execExpression(e.expr,t);return this.builtIn_log(n.val),t;case"if":var n=this.execIf(e,t);return n;case"ifElse":var n=this.execIfElse(e,t);return n;case"goto":var n=this.execGoto(e,t);return n;case"start":var n=this.execStart(e,t);return n;case"end":var n=this.execEnd(e,t);return n;case"force":return t;case"control_goto":var n=this.execControlGoto(e,t);return n;case"control_ifElse":var n=this.execControlIfElse(e,t);return n;case"move_func":var n=this.execMoveFunc(e,t);return n;case"rollback_func":var n=this.execRollbackFunc(e,t);return n;case"sleep_func":var n=this.execSleepFunc(e,t);return n;case"begin_scope":var n=this.execBeginScope(e,t);return n;case"set_return_result":var n=this.execSetReturnResultUnit(e,t);return n;case"end_scope":var n=this.execEndScope(e,t);return n;case"limit_scope":var n=this.execLimitScope(e,t);return n;default:i.notExhaustive(e)}},e.execControlIfElse=function(e,t){var n=this.execExpression(e.conditionExpr,t);null===n.boolVal&&this.makeError("if condition must be of type bool");var a=t.players[t.currentPlayerIndex].tokens[t.currentPlayerActiveTokenIndex];return r.__assign({},t,{players:t.players.map(function(l,i){return i!==t.currentPlayerIndex?l:r.__assign({},l,{tokens:l.tokens.map(function(l,i){return i!==t.currentPlayerActiveTokenIndex?l:r.__assign({},l,{fieldId:!0===n.boolVal?e.trueTargetId:e.falseTargetId,previousPositions:a.previousPositions.concat({tileGuid:a.tileGuid,fieldId:a.fieldId})})})})}),leftDiceValue:t.leftDiceValue-1,elapsedTimeInS:n.state.elapsedTimeInS+s.timeInS_goto()})},e.execControlGoto=function(e,t){var n=t.players[t.currentPlayerIndex].tokens[t.currentPlayerActiveTokenIndex];return r.__assign({},t,{players:t.players.map(function(a,l){return l!==t.currentPlayerIndex?a:r.__assign({},a,{tokens:a.tokens.map(function(a,l){return l!==t.currentPlayerActiveTokenIndex?a:r.__assign({},a,{fieldId:e.targetId,previousPositions:n.previousPositions.concat({tileGuid:n.tileGuid,fieldId:n.fieldId})})})})}),leftDiceValue:t.leftDiceValue-1,elapsedTimeInS:t.elapsedTimeInS+s.timeInS_goto()})},e.execBeginScope=function(e,t){return r.__assign({},t,{players:t.players.map(function(e,n){return n!==t.currentPlayerIndex?e:r.__assign({},e,{localDefTables:e.localDefTables.concat({isScopeLimited:!1,defTable:{}})})})})},e.execEndScope=function(e,t){return 1===t.players[t.currentPlayerIndex].localDefTables.length&&this.makeError("the initial scope cannot be closed/ended"),r.__assign({},t,{players:t.players.map(function(e,n){return n!==t.currentPlayerIndex?e:r.__assign({},e,{localDefTables:e.localDefTables.filter(function(t,n){return n<e.localDefTables.length-1})})})})},e.execLimitScope=function(e,t){return r.__assign({},t,{players:t.players.map(function(e,n){return n!==t.currentPlayerIndex?e:r.__assign({},e,{localDefTables:e.localDefTables.map(function(t,n){return n!==e.localDefTables.length-1?t:r.__assign({},t,{isScopeLimited:!0})})})})})},e.execSetReturnResultUnit=function(e,t){var n=this.execExpression(e.expr,t);return t=n.state,null===n.val&&null===n.boolVal&&this.makeError("assigning return result expression did not give a result"),r.__assign({},t,{players:t.players.map(function(e,a){return a!==t.currentPlayerIndex?e:r.__assign({},e,{lastReturnedValue:null!==n.val?n.val:n.boolVal})}),elapsedTimeInS:t.elapsedTimeInS+s.timeInS_set_var()})},e.execSleepFunc=function(e,t){var n=this.execExpression(e.roundsExpr,t);t=n.state,null===n.val&&this.makeError("sleep function rounds arg needs to be of type int");var l=this.getSomePlayerIndex(e.player,t,"unknown player for sleep function");return r.__assign({},t,{players:t.players.map(function(e,t){return t!==l?e:r.__assign({},e,{suspendCounter:Math.max(e.suspendCounter+n.val,0)})}),leftDiceValue:e.player===a.SomePlayer.currentPlayer?0:t.leftDiceValue})},e.execMoveFunc=function(e,t){var n=this.execExpression(e.numStepsExpr,t);return null===n.val&&this.makeError("move argument must return an int"),t=n.state,r.__assign({},t,{leftDiceValue:t.leftDiceValue+n.val})},e.execRollbackFunc=function(e,t){return null===t.rollbackState?t:r.__assign({},t.rollbackState,{leftDiceValue:0,wasStateRolledBack:!0,elapsedTimeInS:t.elapsedTimeInS+s.timeInS_rollback()})},e.execStart=function(e,t){if(null===e.startCondition)return t;var n=this.execExpression(e.startCondition,t);return null===n.boolVal&&this.makeError("start condition must be of type bool"),r.__assign({},t,{elapsedTimeInS:n.state.elapsedTimeInS})},e.execEnd=function(e,t){var n=t.players[t.currentPlayerIndex];return r.__assign({},t,{winnersIds:t.winnersIds.concat(n.id)})},e.execGoto=function(e,t){return r.__assign({},t,{players:t.players.map(function(n,a){return a!==t.currentPlayerIndex?n:r.__assign({},n,{tokens:n.tokens.map(function(n,a){return a!==t.currentPlayerActiveTokenIndex?n:r.__assign({},n,{fieldId:e.targetId})})})}),elapsedTimeInS:t.elapsedTimeInS+s.timeInS_goto()})},e.execIf=function(e,t){var n=this.execExpression(e.conditionExpr,t);if(null===n.boolVal&&this.makeError("if condition must be of type bool"),!1===n.boolVal)return n.state;for(var r=n.state,a=0;a<e.trueUnits.length;a++){var l=e.trueUnits[a];r=this.executeStatement(l,r)}return r},e.execIfElse=function(e,t){var n=this.execExpression(e.conditionExpr,t);null===n.boolVal&&this.makeError("if else condition must be of type bool");var r=n.state;if(!1===n.boolVal){for(var a=0;a<e.falseUnits.length;a++){var l=e.falseUnits[a];r=this.executeStatement(l,r)}return r}for(var a=0;a<e.trueUnits.length;a++){var l=e.trueUnits[a];r=this.executeStatement(l,r)}return r},e.execVarDecl=function(e,t){var n=this,l=t.players[t.currentPlayerIndex].localDefTables,i=l.length-1;l[i].defTable[e.ident]&&this.makeError("var "+e.ident+" is already defined in current local vars scope");var o=this.execExpression(e.expr,t);t=o.state;return e.var_type===a.VarType.int?(null!==o.boolVal&&this.makeError("var "+e.ident+" is of type int but expression is of type bool"),r.__assign({},t,{players:t.players.map(function(a,l){return l!==t.currentPlayerIndex?a:r.__assign({},a,{localDefTables:a.localDefTables.map(function(t,a){return a!==i?t:r.__assign({},t,{defTable:r.__assign({},t.defTable,(l={},l[e.ident]={ident:e.ident,val:n.circularArithmeticVal(o.val,e.maxVal+1,e.maxVal),maxVal:e.maxVal},l))});var l})})}),elapsedTimeInS:o.state.elapsedTimeInS+s.timeInS_var_decl()})):e.var_type===a.VarType.bool?(null!==o.val&&this.makeError("var "+e.ident+" is of type bool but expression is of type int"),r.__assign({},t,{players:t.players.map(function(n,a){return a!==t.currentPlayerIndex?n:r.__assign({},n,{localDefTables:n.localDefTables.map(function(t,n){return n!==i?t:r.__assign({},t,{defTable:r.__assign({},t.defTable,(a={},a[e.ident]={ident:e.ident,boolVal:o.boolVal},a))});var a})})}),elapsedTimeInS:o.state.elapsedTimeInS+s.timeInS_var_decl()})):void this.makeError("var type for var "+e.ident+" is unknown")},e.execExpression=function(e,t){switch(e.right.type){case"assignment":var n=this.execAssign(e.right,t);return n;case"ternary_expression":var n=this.execTernaryExpr(e.right,t);return n;case"player_var_assign":var n=this.execPlayerVarAssign(e.right,t);return n;default:i.notExhaustive(e.right)}},e.execAssign=function(e,t){var n=this,a=this.execExpression(e.expr,t);if(t=a.state,t.players[t.currentPlayerIndex].localDefTables.length>0)for(var i=t.players[t.currentPlayerIndex].localDefTables.length-1,o=this;i>=0;){var u=function(){var u=t.players[t.currentPlayerIndex].localDefTables[i];if(u.isScopeLimited)return"break";var c=u.defTable[e.ident];return void 0===c?(i--,"continue"):l.isBoolVar(c)?(null===a.boolVal&&o.makeError("assignment error: tried to assign a not bool value to the bool variable "+e.ident),{value:{val:null,boolVal:a.boolVal,state:r.__assign({},t,{players:t.players.map(function(n,l){return l!==t.currentPlayerIndex?n:r.__assign({},n,{localDefTables:n.localDefTables.map(function(t,n){return n!==i?t:r.__assign({},t,{defTable:r.__assign({},t.defTable,(l={},l[e.ident]={ident:e.ident,boolVal:a.boolVal},l))});var l})})}),elapsedTimeInS:t.elapsedTimeInS+s.timeInS_set_var()})}}):l.isIntVar(c)?(null===a.val&&o.makeError("assignment error: tried to assign a not int value to the int variable "+e.ident),{value:{val:a.val,boolVal:null,state:r.__assign({},t,{players:t.players.map(function(l,o){return o!==t.currentPlayerIndex?l:r.__assign({},l,{localDefTables:l.localDefTables.map(function(t,l){return l!==i?t:r.__assign({},t,{defTable:r.__assign({},t.defTable,(o={},o[e.ident]={ident:e.ident,maxVal:c.maxVal,val:n.circularArithmeticVal(a.val,c.maxVal+1,c.maxVal)},o))});var o})})}),elapsedTimeInS:t.elapsedTimeInS+s.timeInS_set_var()})}}):void 0}();if("object"==typeof u)return u.value;if("break"===u)break}if(void 0!==t.players[t.currentPlayerIndex].defTable[e.ident]){var c=t.players[t.currentPlayerIndex].defTable[e.ident];return this._execPlayerVarAssign(c,t.currentPlayerIndex,a,t)}var f=t.globalDefTable[e.ident];if(f||this.makeError("var "+e.ident+" is not defined"),l.isBoolVar(f)){null===a.boolVal&&this.makeError("global var "+e.ident+" assing: cannot assign not bool expr to bool var");var p={val:null,boolVal:a.boolVal,state:r.__assign({},a.state,{globalDefTable:r.__assign({},a.state.globalDefTable,(d={},d[e.ident]={ident:e.ident,boolVal:a.boolVal},d)),elapsedTimeInS:a.state.elapsedTimeInS+s.timeInS_set_var()})};return p}if(l.isIntVar(f)){null===a.val&&this.makeError("global var "+e.ident+" assing: cannot assign not int expr to int var");var _=this.circularArithmeticVal(a.val,f.maxVal+1,f.maxVal),p={val:_,boolVal:null,state:r.__assign({},a.state,{globalDefTable:r.__assign({},a.state.globalDefTable,(m={},m[e.ident]={ident:e.ident,val:_,maxVal:f.maxVal},m)),elapsedTimeInS:a.state.elapsedTimeInS+s.timeInS_set_var()})};return p}return this.makeError("global var "+e.ident+" assing: unknown variable type"),{state:t,val:null,boolVal:null};var d,m},e.execTernaryExpr=function(e,t){if(null!==e.disjunction){return this.execDisjunction(e.disjunction,t)}null===e.condition&&this.makeError("ternary expression has no condition"),null===e.trueExpression&&this.makeError("ternary expression has no true expression (left)"),null===e.falseExpression&&this.makeError("ternary expression has no false expression (right)");var n=this.execDisjunction(e.condition,t);t=n.state,null===n.boolVal&&this.makeError("ternary expression condition didn't evaluate to a bool");var a=r.__assign({},t),l=r.__assign({},t),i=this.execExpression(e.trueExpression,a),o=this.execExpression(e.falseExpression,l);return null!==i.val&&null!==o.val||null!==i.boolVal&&null!==o.boolVal||this.makeError("ternary expression both values must be of the same type"),n.boolVal?i:o},e.execDisjunction=function(e,t){if(null===e.left){return this.execConjunction(e.right,t)}var n=this.execDisjunction(e.left,t),a=this.execConjunction(e.right,n.state);return null===n.boolVal&&this.makeError("disjunction (or) left op must be of type bool"),null===a.boolVal&&this.makeError("disjunction (or) right op must be of type bool"),{state:r.__assign({},a.state,{elapsedTimeInS:a.state.elapsedTimeInS+s.timeInS_expr_disjunction()}),val:null,boolVal:n.boolVal||a.boolVal}},e.execConjunction=function(e,t){if(null===e.left){return this.execComparison(e.right,t)}var n=this.execConjunction(e.left,t),a=this.execComparison(e.right,n.state);return null===n.boolVal&&this.makeError("conjunction (and) left op must be of type bool"),null===a.boolVal&&this.makeError("conjunction (and) right op must be of type bool"),{state:r.__assign({},a.state,{elapsedTimeInS:a.state.elapsedTimeInS+s.timeInS_expr_conjunction()}),val:null,boolVal:n.boolVal&&a.boolVal}},e.execComparison=function(e,t){if(null===e.left){return this.execRelation(e.right,t)}null===e.op&&this.makeError("comarison op was null, must be one of ==, !==");var n=this.execRelation(e.left,t),a=this.execRelation(e.right,n.state);return null!==n.val&&null!==a.val?{state:r.__assign({},a.state,{elapsedTimeInS:a.state.elapsedTimeInS+s.timeInS_expr_comparison()}),val:null,boolVal:"=="===e.op?n.val===a.val:"!="===e.op?n.val!==a.val:this.makeError("unknown comarison op, must be one of ==, !==")}:null!==n.boolVal&&null!==a.boolVal?{state:r.__assign({},a.state,{elapsedTimeInS:a.state.elapsedTimeInS+s.timeInS_expr_comparison()}),val:null,boolVal:"=="===e.op?n.boolVal===a.boolVal:"!="===e.op?n.boolVal!==a.boolVal:this.makeError("unknown comarison op, must be one of ==, !==")}:(this.makeError("comparison operands must be of same type"),{val:null,state:a.state,boolVal:null})},e.execRelation=function(e,t){if(null===e.left){return this.execSum(e.right,t)}if(null===e.op)return this.makeError("no op for relation, expected one of <, >, <=, >="),{val:null,state:t,boolVal:null};var n=this.execSum(e.left,t),a=this.execSum(e.right,n.state);return null!==n.boolVal?(this.makeError("relation left type is bool but need to be int"),{val:null,state:a.state,boolVal:null}):null!==a.boolVal?(this.makeError("relation right type is bool but need to be int"),{val:null,state:a.state,boolVal:null}):null!==n.val&&null!==a.val?{state:r.__assign({},a.state,{elapsedTimeInS:a.state.elapsedTimeInS+s.timeInS_expr_relation()}),val:null,boolVal:"<"===e.op?n.val<a.val:">"===e.op?n.val>a.val:">="===e.op?n.val>=a.val:"<="===e.op?n.val<=a.val:this.makeError("unknown sum op")}:(this.makeError("internal error on relation"),{val:42,state:a.state,boolVal:null})},e.execSum=function(e,t){if(null===e.left){return this.execTerm(e.right,t)}var n=this.execSum(e.left,t),a=this.execTerm(e.right,n.state);return null===e.op?(this.makeError("no op for sum, expected on of +, -"),{val:42,state:a.state,boolVal:null}):null!==n.boolVal?(this.makeError("sum (+,-) ops cannot have bool args"),{val:null,boolVal:null,state:a.state}):null!==a.boolVal?(this.makeError("sum (+,-) ops cannot have bool args"),{val:null,boolVal:null,state:a.state}):{state:r.__assign({},a.state,{elapsedTimeInS:a.state.elapsedTimeInS+s.timeInS_expr_sum()}),boolVal:null,val:"+"===e.op?n.val+a.val:"-"===e.op?n.val-a.val:this.makeError("unknown sum op")}},e.execTerm=function(e,t){if(null===e.left){return this.execFactor(e.right,t)}if(null===e.op)return this.makeError("no op for term"),{val:null,boolVal:null,state:t};var n=this.execTerm(e.left,t);if(null!==n.boolVal)return this.makeError("mul (*,/,%) ops cannot have bool args"),{val:null,boolVal:null,state:n.state};var a=this.execFactor(e.right,n.state);return null!==a.boolVal?(this.makeError("mul (*,/,%) ops cannot have bool args"),{val:null,boolVal:null,state:t}):{state:r.__assign({},a.state,{elapsedTimeInS:a.state.elapsedTimeInS+s.timeInS_expr_term()}),boolVal:null,val:"*"===e.op?this.forceIntVal(n.val*a.val):"/"===e.op?this.forceIntVal(n.val/a.val):"%"===e.op?this.forceIntVal(n.val%a.val):this.makeError("unknown op for term")}},e.execFactor=function(e,t){if(null===e.left){return this.execPrimary(e.right,t)}var n=this.execFactor(e.left,t);return null!==n.boolVal?{state:r.__assign({},n.state,{elapsedTimeInS:n.state.elapsedTimeInS+s.timeInS_expr_factor()}),val:null,boolVal:"not"===e.unOp?!n.boolVal:n.boolVal}:{state:r.__assign({},n.state,{elapsedTimeInS:n.state.elapsedTimeInS+s.timeInS_expr_factor()}),boolVal:null,val:"+"===e.unOp?n.val:-n.val}},e.execPrimary=function(e,t){switch(e.primary.type){case"expression":return this.execExpression(e.primary,t);case"primary_ident_leftSteps":return{val:t.leftDiceValue,boolVal:null,state:r.__assign({},t,{elapsedTimeInS:t.elapsedTimeInS+s.timeInS_expr_primary_leftSteps()})};case"primary_roll_dice_func":var n=t.maxDiceValue;if(null!==e.primary.maxValExpr){var a=this.execExpression(e.primary.maxValExpr,t);null===a.val&&this.makeError("roll dice argument must return an int"),n=a.val,t=a.state}var l=this.rollDice(t,1,n);return{state:r.__assign({},l.state),boolVal:null,val:l.diceValue};case"primary_choose_bool_func":var o=this.rollDice(t,0,1);return{state:r.__assign({},o.state,{elapsedTimeInS:o.state.elapsedTimeInS-s.timeInS_rollDice()+s.timeInS_choose_bool_func()}),val:null,boolVal:1===o.diceValue};case"primary_constant":return null!==e.primary.intValue?{val:e.primary.intValue,boolVal:null,state:r.__assign({},t,{elapsedTimeInS:t.elapsedTimeInS+s.timeInS_expr_primary_constant()})}:null!==e.primary.boolVal?{val:null,boolVal:e.primary.boolVal,state:r.__assign({},t,{elapsedTimeInS:t.elapsedTimeInS+s.timeInS_expr_primary_constant()})}:(this.makeError("constant is no int, bool"),{boolVal:null,val:null,state:t});case"primary_decrement":case"primary_increment":return this.execPrimary_inc_or_decrement(e.primary,t);case"primary_ident":return this.execPrimary_ident(e.primary,t);case"primary_player_var_ident":return this.execPrimary_player_var(e.primary,t);case"primary_ident_last_result":var u=t.players[t.currentPlayerIndex].lastReturnedValue;return void 0===u&&this.makeError("last result value was not set yet"),{boolVal:"boolean"==typeof u?u:null,val:"number"==typeof u?u:null,state:r.__assign({},t,{elapsedTimeInS:t.elapsedTimeInS+s._timeInS_expr_primary_ident})};default:i.notExhaustive(e.primary)}},e.execPrimary_inc_or_decrement=function(e,t){var n=this,a="primary_increment"===e.type;if(null!==e.player){var i=this.getSomePlayerIndex(e.player,t,"primary_increment invalid player"),o=t.players[i].defTable[e.ident];if(void 0===o)return this.makeError("def tab entry for player ident "+e.ident+" not found"),{state:t,val:null,boolVal:null};if(l.isBoolVar(o))return this.makeError("bool var player ident "+e.ident+" cannot be increment (only ints)"),{val:null,boolVal:null,state:t};var u=o.val+(a?1:-1);return{val:e.isPost?o.val:u,boolVal:null,state:r.__assign({},t,{players:t.players.map(function(t,a){return a!==i?t:r.__assign({},t,{defTable:r.__assign({},t.defTable,(l={},l[e.ident]={val:n.circularArithmeticVal(u,o.maxVal+1,o.maxVal),maxVal:o.maxVal,ident:e.ident},l))});var l}),elapsedTimeInS:t.elapsedTimeInS+s.timeInS_expr_primary_incrementOrDecrement()})}}if(t.players[t.currentPlayerIndex].localDefTables.length>0)for(var c=t.players[t.currentPlayerIndex].localDefTables.length-1,f=this;c>=0;){var p=function(){var i=t.players[t.currentPlayerIndex].localDefTables[c];if(i.isScopeLimited)return"break";var o=i.defTable[e.ident];if(void 0===o)return c--,"continue";if(l.isBoolVar(o))return f.makeError("bool local ident "+e.ident+" cannot be increment (only ints)"),{value:{val:null,boolVal:null,state:t}};var u=o.val+(a?1:-1);return{value:{val:e.isPost?o.val:u,boolVal:null,state:r.__assign({},t,{players:t.players.map(function(a,l){return l!==t.currentPlayerIndex?a:r.__assign({},a,{localDefTables:a.localDefTables.map(function(t,a){return a!==c?t:r.__assign({},t,{defTable:r.__assign({},t.defTable,(l={},l[e.ident]={val:n.circularArithmeticVal(u,o.maxVal+1,o.maxVal),maxVal:o.maxVal,ident:e.ident},l))});var l})})}),elapsedTimeInS:t.elapsedTimeInS+s.timeInS_expr_primary_incrementOrDecrement()})}}}();if("object"==typeof p)return p.value;if("break"===p)break}var _=t.players[t.currentPlayerIndex].defTable[e.ident];if(void 0!==_){if(l.isBoolVar(_))return this.makeError("bool var player ident "+e.ident+" cannot be increment (only ints)"),{val:null,boolVal:null,state:t};var d=_.val+(a?1:-1);return{val:e.isPost?_.val:d,boolVal:null,state:r.__assign({},t,{players:t.players.map(function(a,l){return l!==t.currentPlayerIndex?a:r.__assign({},a,{defTable:r.__assign({},a.defTable,(i={},i[e.ident]={val:n.circularArithmeticVal(d,_.maxVal+1,_.maxVal),maxVal:_.maxVal,ident:e.ident},i))});var i}),elapsedTimeInS:t.elapsedTimeInS+s.timeInS_expr_primary_incrementOrDecrement()})}}var m=t.globalDefTable[e.ident];if(!m)return this.makeError("global def tab entry for ident "+e.ident+" not found"),{state:t,val:null,boolVal:null};if(l.isBoolVar(m))return this.makeError("global bool var ident "+e.ident+" cannot be increment (only ints)"),{val:null,boolVal:null,state:t};var v=m.val+(a?1:-1);return{val:e.isPost?m.val:v,boolVal:null,state:r.__assign({},t,{globalDefTable:r.__assign({},t.globalDefTable,(x={},x[e.ident]={ident:e.ident,val:this.circularArithmeticVal(v,m.maxVal+1,m.maxVal),maxVal:m.maxVal},x)),elapsedTimeInS:t.elapsedTimeInS+s.timeInS_expr_primary_incrementOrDecrement()})};var x},e.execPrimary_player_var=function(e,t){var n=this.getSomePlayerIndex(e.player,t,"primary_player_var_ident unknown player"),r=t.players[n].defTable[e.ident];return r||this.makeError("primary_player_var_ident unknown var "+e.ident+" for player"),this.getDefTableVariable(r,t,"primary_player_var_ident unknown var "+e.ident+" unknown type??")},e.execPrimary_ident=function(e,t){if(t.players[t.currentPlayerIndex].localDefTables.length>0)for(var n=t.players[t.currentPlayerIndex].localDefTables.length-1;n>=0;){var r=t.players[t.currentPlayerIndex].localDefTables[n];if(r.isScopeLimited)break;var a=r.defTable[e.ident];{if(void 0!==a)return this.getDefTableVariable(a,t,"no type found for ident "+e.ident);n--}}if(t.players[t.currentPlayerIndex].defTable[e.ident])return this.execPrimary_player_var({player:t.currentPlayerIndex,ident:e.ident,type:"primary_player_var_ident"},t);var l=t.globalDefTable[e.ident];return l||this.makeError("variable "+e.ident+" was not found (searched all scopes)"),this.getDefTableVariable(l,t,"no type found for ident "+e.ident)},e.getDefTableVariable=function(e,t,n){if(l.isIntVar(e)){var a=e.val;return{val:a,boolVal:null,state:r.__assign({},t,{elapsedTimeInS:t.elapsedTimeInS+s.timeInS_expr_primary_ident()})}}if(l.isBoolVar(e)){var a=e.boolVal;return{val:null,boolVal:a,state:r.__assign({},t,{elapsedTimeInS:t.elapsedTimeInS+s.timeInS_expr_primary_ident()})}}this.makeError(n)},e.getSomePlayerIndex=function(e,t,n){return e===a.SomePlayer.currentPlayer?t.currentPlayerIndex:e===a.SomePlayer.nextPlayer?t.nextPlayerIndex:e===a.SomePlayer.previousPlayer?t.previousPlayerIndex:this.makeError(n)},e.circularArithmeticVal=function(e,t,n){var r=t+n+1,a=-t;if(a===e)return e;return e<=0?(e+a)%r-a:(e-a)%r+a},e.forceIntVal=function(e){return Math.floor(e)},e.makeError=function(e){throw Error(e)},e.builtIn_log=function(e){console.log(e)},e}();t.AbstractMachine=c}});